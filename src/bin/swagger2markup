#!/bin/bash
#===================================================================================================
#
# swagger2markup-cli wrapper
#
#===================================================================================================
#---------------------------------------------------------------------------------------------------
# 設定
#---------------------------------------------------------------------------------------------------
dir_script="$(dirname $0)"
cd "$(cd ${dir_script}; pwd)" || exit 6

# 共通設定
readonly DIR_BASE="$(cd ..; pwd)"
. "./setenv"

# loggingユーティリティ
readonly PATH_LOG=/dev/null
. "${DIR_BIN_LIB}/logging_utils.sh"


#---------------------------------------------------------------------------------------------------
# 前提チェック
#---------------------------------------------------------------------------------------------------
# swagger2markup
if [[ ! -f "${PATH_MARKUP}" ]]; then
  log.error_console "$(basename ${PATH_MARKUP}) がインストールされていません。"
  exit ${EXITCODE_ERROR}
fi


#---------------------------------------------------------------------------------------------------
# 関数定義
#---------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------
# usage
#--------------------------------------------------------------------------------
function usage() {
  java -jar "${PATH_MARKUP}" help convert
  exit ${EXITCODE_ERROR}
}


#---------------------------------------------------------------------------------------------------
# 事前処理
#---------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
# オプション解析
#-------------------------------------------------------------------------------
while :; do
  case $1 in
    -h|--help)
      usage
      ;;
    --)
      shift
      break
      ;;
    *)
      break
      ;;
  esac
done



#---------------------------------------------------------------------------------------------------
# 本処理
#---------------------------------------------------------------------------------------------------
retcode=${EXITCODE_SUCCESS}

# そのままswagger2markupを起動
cmd="java -jar ${PATH_MARKUP} $*"

# 実行
log.info_console "$(echo ${cmd} | _sp_multi2single)"
${cmd}
retcode=$?


#---------------------------------------------------------------------------------------------------
# 事後処理
#---------------------------------------------------------------------------------------------------
exit ${retcode}
